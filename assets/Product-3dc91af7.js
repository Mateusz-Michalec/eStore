import{r as d,d as I,j as e,b as P,A as C,S as A,s as E,v as T,w as z,x as L,y as D,z as O,L as N,C as W,q as y,B as S,D as k}from"./index-ac86e50b.js";import{S as $}from"./Sizes-05689de0.js";import{r as F}from"./MathUtils-a71e7da3.js";import{P as H}from"./ProductPreview-a4a1c3c1.js";import{c as Q,L as V}from"./ProductDataManipulation-92dee634.js";import{R as q,B as w}from"./Row-1a16fe8d.js";const v=d.forwardRef(({bsPrefix:t,active:a=!1,children:r,className:c,as:o="li",linkAs:i=C,linkProps:m={},href:l,title:n,target:f,...h},s)=>{const j=I(t,"breadcrumb-item");return e.jsx(o,{ref:s,...h,className:P(j,c,{active:a}),"aria-current":a?"page":void 0,children:a?r:e.jsx(i,{...m,href:l,title:n,target:f,children:r})})});v.displayName="BreadcrumbItem";const G=v,B=d.forwardRef(({bsPrefix:t,className:a,listProps:r={},children:c,label:o="breadcrumb",as:i="nav",...m},l)=>{const n=I(t,"breadcrumb");return e.jsx(i,{"aria-label":o,className:a,ref:l,...m,children:e.jsx("ol",{...r,className:P(n,r==null?void 0:r.className),children:c})})});B.displayName="Breadcrumb";const x=Object.assign(B,{Item:G});function J(t,a){const[r,c]=d.useState(!1);return d.useEffect(()=>{const o=new IntersectionObserver(i=>{i[0].isIntersecting?c(!0):c(!1)});return t.current&&o.observe(t.current),()=>o.disconnect()},[a,t]),r}function K({ratingRate:t,ratingCount:a}){function r(){const o=[];let i=F(t);const m=i%2!==0;m&&(i=i-.5);let l;for(let n=0;n<5;n++)n<i?l="bi-star-fill":n==i&&m?l="bi-star-half":l="bi-star",o.push(e.jsx("i",{className:`bi ${l}`},n));return o}const[c]=d.useState(r);return e.jsxs("section",{className:"mt-2 mb-3",children:[e.jsxs("span",{className:"fs-7",children:["Ocena ",t," (",a," recenzji)"]}),e.jsx(A,{direction:"horizontal",gap:2,children:c})]})}function ee(){const t=E(),{id:a}=T(),[r,c]=d.useState(""),o=z(u=>L(u,a)),i=z(u=>D(u,a,r)),{data:m,isLoading:l,isSuccess:n,isFetching:f,refetch:h}=O(a);d.useEffect(()=>{h()},[a]);const[s,j]=d.useState(null);d.useEffect(()=>{n&&j(Q(m,o))},[n,a,f]);const p=d.useRef(),b=d.useRef(),R=J(b,s);function g(){s.sizes?r&&r!=="Wybierz rozmiar"?(t(S({id:s.id,size:r,sizeQuantity:i})),t(k("Produkt dodany do koszyka!","cart"))):(c("Wybierz rozmiar"),window.scrollTo({top:b.current.offsetTop-85})):(t(S({id:s.id,available:s.available})),t(k("Produkt dodany do koszyka!","cart")))}return e.jsx(e.Fragment,{children:l||f||!s?e.jsx("div",{className:"loader"}):e.jsxs(e.Fragment,{children:[e.jsxs("article",{className:"d-flex flex-column mb-4",children:[e.jsxs(x,{className:"fs-7 d-flex justify-content-center mb-4",children:[e.jsx(x.Item,{linkAs:N,linkProps:{to:"/"},children:"Home"}),e.jsx(x.Item,{linkAs:N,linkProps:{to:`/products/category/${s.category}`},children:s.category}),e.jsx(x.Item,{active:!0,children:s.title})]}),e.jsx(W,{children:e.jsxs(q,{className:"gap-3",children:[e.jsx(y,{sm:12,md:6,children:e.jsx(H,{product:s,component:"Product"})}),e.jsxs(y,{children:[e.jsxs("section",{children:[e.jsx("h1",{className:"h4 mb-1",children:s.title}),e.jsxs("h2",{className:"h5 mb-0 text-danger",children:[s.price," PLN"]})]}),e.jsx(K,{ratingRate:s.rating.rate,ratingCount:s.rating.count}),s.sizes?e.jsx("section",{ref:b,children:e.jsx($,{component:"Product",sizes:s.sizes,selectedSize:r,handleSizeSelect:u=>c(u.currentTarget.id)})}):null,R?null:e.jsx("div",{className:"fixed-bottom fixed-btn d-md-none px-4 py-3 bg-white border-1 border-top shadow",children:e.jsxs(w,{variant:s.sizes&&!r||r==="Wybierz rozmiar"?"secondary":"dark",ref:p,className:"rounded-0 py-3 w-100",onClick:()=>g(),children:[e.jsx("i",{className:"bi bi-bag me-2 text-white"}),e.jsx("strong",{className:"ls-1",children:"Dodaj"})]})}),e.jsxs(w,{variant:s.sizes&&!r||r==="Wybierz rozmiar"?"secondary":"dark",ref:p,className:"rounded-0 py-3 mt-3 w-100",onClick:()=>g(),children:[e.jsx("i",{className:"bi bi-bag me-2 text-white"}),e.jsx("strong",{className:"ls-1",children:"Dodaj"})]}),e.jsxs("section",{className:"mt-4 ls-1",children:[e.jsx("h3",{className:"h5",children:"Opis"}),e.jsx("p",{className:" text-secondary",children:s.description})]})]})]})})]}),n?e.jsx(V,{productId:s.id}):null]})})}export{ee as default};
